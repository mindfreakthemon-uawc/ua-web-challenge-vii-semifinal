{"version":3,"sources":["views/app.view.js"],"names":[],"mappings":"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","file":"views/app.view.js","sourcesContent":["define([\n\t\t'backbone',\n\t\t'entities/router',\n\n\t\t'models/subreddit.model',\n\t\t'models/post.model',\n\t\t'collections/posts.collection',\n\t\t'collections/comments.collection',\n\t\t'views/subreddit.view',\n\t\t'views/posts.view',\n\t\t'views/comments.view'\n\t],\n\tfunction (Backbone, router, Subreddit, Post, PostsCollection, CommentsCollection, SubredditView, PostsView, CommentsView) {\n\t\treturn Backbone.View.extend({\n\t\t\tel: '#viewport',\n\n\t\t\tevents: {\n\t\t\t\t'click .fn-click': 'redirect',\n\t\t\t\t'click a': 'redirect'\n\t\t\t},\n\n\t\t\tinitialize: function () {\n\t\t\t\tthis.router = router;\n\n\t\t\t\trouter.route('?/:subreddit(/:type)(/:page/:anchor_type/:anchor)(/)', 'reddit', this.reddit.bind(this));\n\t\t\t\trouter.route('?/:subreddit/comments/:id/:name(/)', 'post', this.post.bind(this));\n\n\t\t\t\tthis.listenTo(router, 'routing', function () {\n\t\t\t\t\tthis.$el.empty();\n\t\t\t\t});\n\t\t\t},\n\n\t\t\treddit: function (name, type, page, anchorType, anchor) {\n\t\t\t\ttype || (type = 'hot');\n\t\t\t\tpage = page | 0;\n\n\t\t\t\tthis.subreddit(name, type)\n\t\t\t\t\t.$el.appendTo(this.$el);\n\n\t\t\t\tvar posts = new PostsCollection(null, {\n\t\t\t\t\tname: name,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tpage: page,\n\t\t\t\t\tanchorType: anchorType,\n\t\t\t\t\tanchor: anchor\n\t\t\t\t});\n\n\t\t\t\tthis.listenTo(posts, 'reset', function () {\n\t\t\t\t\tvar page = posts.state.currentPage,\n\t\t\t\t\t\tpagePath = page ? '/' + posts.state.currentPage + '/' + posts.state.anchorType + '/' + posts.state.anchor : '';\n\n\t\t\t\t\tthis.router.navigate('?/' + name + '/' + type + pagePath);\n\t\t\t\t});\n\n\t\t\t\tvar postsView = new PostsView({\n\t\t\t\t\tcollection: posts\n\t\t\t\t});\n\n\t\t\t\tpostsView.$el.appendTo(this.$el);\n\n\t\t\t\tif (type === 'hot' && page === 0) {\n\t\t\t\t\t// load first 25 comment pages\n\t\t\t\t\tthis.listenToOnce(posts, 'reset', function () {\n\t\t\t\t\t\tposts.models.forEach(function (post) {\n\t\t\t\t\t\t\tfetch('https://www.reddit.com' + post.get('permalink').replace(/\\/$/, '') + '.json');\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tposts.fetch({ reset: true });\n\t\t\t},\n\n\t\t\tpost: function (name, id, title) {\n\t\t\t\tthis.subreddit(name, 'comment')\n\t\t\t\t\t.$el.appendTo(this.$el);\n\n\t\t\t\tvar comments = new CommentsCollection(null, {\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tname: name,\n\t\t\t\t\tid: id\n\t\t\t\t});\n\n\t\t\t\tvar commentsView = new CommentsView({\n\t\t\t\t\tcollection: comments\n\t\t\t\t});\n\n\t\t\t\tcommentsView.$el.appendTo(this.$el);\n\t\t\t\tcomments.fetch({ reset: true });\n\t\t\t},\n\n\t\t\tsubreddit: function (name, type) {\n\t\t\t\tvar subreddit = new Subreddit({\n\t\t\t\t\tname: name,\n\t\t\t\t\ttype: type\n\t\t\t\t});\n\n\t\t\t\tvar subredditView = new SubredditView({\n\t\t\t\t\tmodel: subreddit\n\t\t\t\t});\n\n\t\t\t\treturn subredditView.render();\n\t\t\t},\n\n\t\t\tredirect: function (e) {\n\t\t\t\tif (e.target.pathname !== location.pathname || e.target.hostname !== location.hostname) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\n\t\t\t\tvar fragment = e.target.search;\n\n\t\t\t\tif (Backbone.history.fragment === fragment) {\n\t\t\t\t\treturn''\n\t\t\t\t}\n\n\t\t\t\trouter.navigate(e.target.search, { trigger: true });\n\t\t\t}\n\t\t});\n\t});"],"sourceRoot":"/source/"}